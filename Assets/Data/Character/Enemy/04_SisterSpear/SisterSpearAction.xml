<ActionGraph Name="SisterSpearAction" DefaultAction="AC_Idle" DefaultFramePerSecond="12">
<!-- AnimationHeader MasterPath -->
<GlobalVariable Name="gv_MasterPath" Value="Sprites/Enemy/SisterSpear/"/>
<GlobalVariable Name="gv_DeadPath" Value="Resources/Sprites/Enemy/SisterSpear/0_default/4_dead"/>

<!-- Defualt Action -->
    <AC_Idle MovementType="FrameEvent" DirectionType="Keep" FlipType="Direction">
        <AnimationHeader MasterPath="gv_MasterPath"/>
        <Animation Preset="0_default/1_idle" XFlip="true" Duration="1">
            <FrameEvent Type="Movement" StartTime="0" Friction="12" Speed="0"/>
            
            <FrameEvent Type="ApplyBuff" StartTime="0" ApplyBuff="HitCountClear"/>
            <FrameEvent Type="FrameTag" StartTime="0" EndTime="999" Tag="HitAvail"/>
            <FrameEvent Type="FrameTag" StartTime="0" EndTime="999" Tag="GbAvail"/>
        </Animation>

        <Branch Condition="End == true" Execute="AC_Idle"/>
    </AC_Idle>

    <AC_Move MovementType="FrameEvent" DirectionType="AI" FlipType="Direction">
        <AnimationHeader MasterPath="gv_MasterPath"/>
        <Animation Preset="0_default/2_move" XFlip="true" Duration="0.5">
            <FrameEvent Type="Movement" StartTime="0" Friction="0" MaxVelocity="5" Speed="12.0"/>
            <FrameEvent Type="FrameTag" StartTime="0" EndTime="999" Tag="HitAvail"/>
            <FrameEvent Type="FrameTag" StartTime="0" EndTime="999" Tag="GbAvail"/>
        </Animation>

        <Branch Condition="End == true" Execute="AC_Move"/>
    </AC_Move>

    <AC_Hit MovementType="FrameEvent" DirectionType="AttackedPoint" FlipType="Direction">
        <AnimationHeader MasterPath="gv_MasterPath"/>
        <Animation Preset="0_default/3_hit" XFlip="true" Duration="1.25">
            <FrameEvent Type="CallAIEvent" StartTime="0" EventName="CancelLaser" EventTargetType="SummonTargetRange" Range="999.0" AllyTarget="Ally"/>

            <FrameEvent Type="AudioPlay" StartTime="0" ID="4921" Attach="true"/>
            <FrameEvent Type="Movement" StartTime="0" Friction="0" Velocity="0" Speed="0"/>
            <FrameEvent Type="ApplyBuff" StartTime="0" ApplyBuff="HitCountIncrease"/>

            <FrameEvent Type="FrameTag" StartTime="0" EndTime="999" Tag="HitAvail"/>
            <FrameEvent Type="FrameTag" StartTime="0" EndTime="999" Tag="GbAvail"/>
        </Animation>

        <Branch Condition="End == true" Execute="AC_Idle"/>
    </AC_Hit>

    <Dead DirectionType="Keep" FlipType="Direction">
        <AnimationHeader MasterPath="gv_MasterPath"/>
        <Animation Preset="0_default/4_dead" XFlip="true" Duration="1">
            <FrameEvent Type="CallAIEvent" StartTime="0" EventName="CancelLaser" EventTargetType="SummonTargetRange" Range="999.0" AllyTarget="Ally"/>

            <FrameEvent Type="Effect" StartTime="0" Path="gv_DeadPath" FramePerSecond="0.2" CastShadow="True">
                <Physics UseGravity="True" Velocity="Random_-2.5^2.5 Random_1.5^3.5" Friction="1" Torque="Random_-30^30" AngularFriction="10.0"/>
            </FrameEvent>

            <FrameEvent Type="KillEntity" StartTime="0"/>
        </Animation>

        <Branch Condition="End == true" Execute="Dead"/>
    </Dead>

    <AC_PeaceMotionLoop MovementType="FrameEvent" DirectionType="Keep" FlipType="Direction">
        <AnimationHeader MasterPath="gv_MasterPath"/>
        <Animation Preset="0_default/1_idle" XFlip="true" Duration="1">
            <FrameEvent Type="Movement" StartTime="0" Friction="12" Speed="0"/>
            
            <FrameEvent Type="ApplyBuff" StartTime="0" ApplyBuff="HitCountClear"/>
            <FrameEvent Type="ApplyBuff" StartTime="0" ApplyBuff="GuardCountClear"/>

            <FrameEvent Type="FrameTag" StartTime="0" EndTime="999" Tag="HitAvail"/>
            <FrameEvent Type="FrameTag" StartTime="0" EndTime="999" Tag="GbAvail"/>
            
        </Animation>

        <Branch Condition="End == true" Execute="AC_Idle"/>
    </AC_PeaceMotionLoop>
    <AC_PeaceMotionEnd MovementType="FrameEvent" DirectionType="AI" FlipType="Direction">
        <AnimationHeader MasterPath="gv_MasterPath"/>
        <Animation Preset="0_default/1_idle" XFlip="true" Duration="1">
            <FrameEvent Type="Movement" StartTime="0" Friction="12" Speed="0"/>
            <FrameEvent Type="FrameTag" StartTime="0" EndTime="999" Tag="HitAvail"/>
            <FrameEvent Type="FrameTag" StartTime="0" EndTime="999" Tag="GbAvail"/>
            
        </Animation>

        <Branch Condition="End == true" Execute="AC_Idle"/>
    </AC_PeaceMotionEnd>
<!-- Defualt Action -->

<!-- Skill : Attack -->
    <AC_AttackReady MovementType="FrameEvent" DirectionType="AI" FlipType="Direction" Flags="OutlineNormal">
        <AnimationHeader MasterPath="gv_MasterPath"/>
        <Animation Preset="1_attack/1_attackReady" XFlip="true" Duration="0.5">
            <FrameEvent Type="AudioPlay" StartTime="0" ID="2501" Attach="true"/>
            <FrameEvent Type="Movement" StartTime="0" Friction="0" Velocity="0" MaxVelocity="0" Speed="0"/>
            <FrameEvent Type="FrameTag" StartTime="0" EndTime="999" Tag="GbAvail"/>

        </Animation>
    
        <Branch Condition="End" Execute="AC_Idle"/>
    </AC_AttackReady>

    <AC_AttackMain MovementType="FrameEvent" DirectionType="AI" FlipType="Direction" RotationType="Direction" Flags="OutlineNormal">
        <AnimationHeader MasterPath="gv_MasterPath"/>
        <Animation Preset="1_attack/2_attackMain" XFlip="true" Duration="0.55">
            <FrameEvent Type="Movement" StartTime="0" Friction="24" MaxVelocity="18" Velocity="18" Speed="0"/>
            <FrameEvent Type="AudioPlay" StartTime="0" ID="4901" Attach="true" Switch="True"/>
            
            <FrameEvent Type="Attack" StartTime="0" EndTime="0.2" AttackPreset="SisterSpear_Normal" NotifyAttackSuccess="False">
                <OnHit>
                    <FrameEvent Type="ApplyBuffTarget" ApplyBuff="CommonHalfAttack"/>
                    <FrameEvent Type="AudioPlay" StartTime="0" ID="4908" Attach="true" Switch="True"/>
                    <FrameEvent Type="EffectPreset" StartTime="0" Key="Slash"/>
                    <FrameEvent Type="EffectPreset" StartTime="0" Key="Blood"/>
                                        
                    <FrameEvent Type="StopUpdate" Time="0.1"/>
                    <FrameEvent Type="SetTimeScale" Scale="0.1" Time="0.1" BlendTime="0.1"/>
                    <FrameEvent Type="ShakeEffect" Scale="0.1" Speed="10.0" Time="0.1"/>
                </OnHit>
            </FrameEvent>

            <FrameEvent Type="FrameTag" StartTime="0" EndTime="999" Tag="GbAvail"/>
        </Animation>

        <Branch Condition="End" Execute="AC_AttackRecover"/>
    </AC_AttackMain>

    <AC_AttackRecover MovementType="FrameEvent" DirectionType="AI" FlipType="Direction">
        <AnimationHeader MasterPath="gv_MasterPath"/>
        <Animation Preset="1_attack/3_attackRecover" XFlip="true" Duration="1.2">
            <FrameEvent Type="Movement" StartTime="0" Friction="12" Speed="0"/>
            <FrameEvent Type="FrameTag" StartTime="0" EndTime="999" Tag="HitAvail"/>
            <FrameEvent Type="FrameTag" StartTime="0" EndTime="999" Tag="GbAvail"/>
        </Animation>

        <Branch Condition="End" Execute="AC_Idle"/>
    </AC_AttackRecover>
<!-- Skill : Attack -->

<!-- Skill : Tsuba -->
    <AC_Tsuba MovementType="FrameEvent" DirectionType="AI" FlipType="Direction" DefenceType="Evade">
        <AnimationHeader MasterPath="gv_MasterPath"/>
        <Animation Preset="0_default/3_hit" XFlip="true" Duration="1.25">
        </Animation>
        <Trigger Condition="EvadeSuccess">
            <FrameEvent Type="Attack" StartTime="0" EndTime="0.1" AttackPreset="Common_Radius10" AttackType="Catch" CatchOffset="0.1 0 0">
                <OnCatch>
                    <FrameEvent Type="AudioPlay" StartTime="0" ID="2410" Attach="true"/>
                    <FrameEvent Type="ApplyBuff" StartTime="0" ApplyBuff="HitCountClear"/>
                    
                    <FrameEvent Type="ApplyBuffTarget" ApplyBuff="CatchedSet"/>
                    
                    <FrameEvent Type="ZoomEffect" Scale="-0.4"/>
                    <FrameEvent Type="StopUpdate" Time="0.15"/>
                </OnCatch>
            </FrameEvent>
        </Trigger>
        <Branch Condition="End" Execute="AC_Tsuba"/>
    </AC_Tsuba>

    <AC_TsubaEntry MovementType="FrameEvent" DirectionType="Keep" FlipType="Direction">
        <AnimationHeader MasterPath="gv_MasterPath"/>
        <Animation Preset="3_skill/2_tsuba/1_entry" XFlip="true" Duration="0.3">
            <FrameEvent Type="AudioPlay" StartTime="0" ID="2411" Attach="true"/>
            <FrameEvent Type="Movement" StartTime="0" Friction="12"/>
        </Animation>

        <Branch Condition="getKey_Escape_1 || getKey_Escape_2 || End" Execute="AC_TsubaStruggle"/>
    </AC_TsubaEntry>

    <AC_TsubaStruggle MovementType="FrameEvent" DirectionType="Keep" FlipType="Direction">
        <AnimationHeader MasterPath="gv_MasterPath"/>
        <Animation Preset="3_skill/2_tsuba/2_struggle" XFlip="true" Duration="0.3">
            <FrameEvent Type="AudioPlay" StartTime="0" ID="2411" Attach="true"/>
            <FrameEvent Type="Movement" StartTime="0" Friction="12"/>
        </Animation>

        <Branch Condition="getKey_Escape_1 || getKey_Escape_2 || End" Execute="AC_TsubaEntry"/>
    </AC_TsubaStruggle>
 
    <AC_TsubaAttack MovementType="FrameEvent" DirectionType="Keep" FlipType="Direction">
        <AnimationHeader MasterPath="gv_MasterPath"/>
        <Animation Preset="3_skill/2_tsuba/3_attack" XFlip="true" Duration="0.5">
            <FrameEvent Type="AudioPlay" StartTime="0" ID="2412" Attach="true"/>
            <FrameEvent Type="Movement" StartTime="0" Friction="12"/>
            
            <!-- 밀치기, 아카네 딜레이 0.7s-->
            <FrameEvent Type="ReleaseCatch" StartTime="0" Push="5 0 0" TargetAction="AC_AobaTsuba_Fail"/>

            <FrameEvent Type="ZoomEffect" Scale="-1.7"/>
            <FrameEvent Type="StopUpdate" Time="0.07"/>
            <FrameEvent Type="SetTimeScale" Scale="0.7" Time="0.1" BlendTime="0.1"/>
            <FrameEvent Type="ShakeEffect" Scale="0.15" Speed="35.0" Time="0.1"/>

            <FrameEvent Type="FrameTag" StartTime="0.4" EndTime="0.5" Tag="TsubaAttack"/>
        </Animation>

        <Branch Condition="End" Execute="AC_Idle"/>
    </AC_TsubaAttack>

    <AC_TsubaAway MovementType="FrameEvent" DirectionType="Keep" FlipType="Direction">
        <AnimationHeader MasterPath="gv_MasterPath"/>
        <!-- 밀리기 -->
        <Animation Preset="3_skill/2_tsuba/4_away" XFlip="true" Duration="0.9">
            <FrameEvent Type="Movement" StartTime="0" Friction="4" MaxVelocity="9" Velocity="-4" Speed="0"/>
            <FrameEvent Type="FrameTag" StartTime="0" EndTime="999" Tag="HitAvail"/>
            <FrameEvent Type="FrameTag" StartTime="0" EndTime="999" Tag="GbAvail"/>
        </Animation>
        <Animation Preset="3_skill/2_tsuba/4_away" XFlip="true" Duration="0.1">
            <FrameEvent Type="FrameTag" StartTime="0" EndTime="999" Tag="HitAvail"/>
            <FrameEvent Type="FrameTag" StartTime="0" EndTime="999" Tag="GbAvail"/>
        </Animation>

        <Branch Condition="End" Execute="AC_Idle"/>
    </AC_TsubaAway>
<!-- Skill : Tsuba -->

<!-- Defense Action -->
    <AC_Dodge MovementType="GraphPreset" MovementGraphPreset="Preset_Dodge" DirectionType="AI" FlipType="Direction">
        <AnimationHeader MasterPath="gv_MasterPath"/>
        <Animation Preset="2_defense/1_dodge" XFlip="true" Duration="0.7">
            <FrameEvent Type="ApplyBuff" StartTime="0" ApplyBuff="HitCountClear"/>
            <FrameEvent Type="ApplyBuff" StartTime="0" ApplyBuff="GuardCountClear"/>

            <FrameEvent Type="FrameTag" StartTime="0" EndTime="999" Tag="HitAvail"/>
            <FrameEvent Type="FrameTag" StartTime="0" EndTime="999" Tag="GbAvail"/>
        </Animation>

        <Branch Condition="End" Execute="AC_Idle"/>
    </AC_Dodge>

    <AC_Guard MovementType="FrameEvent" DirectionType="AI" FlipType="Direction" DefenceType="Guard" DefenceDirectionType="Direction" DefenceAngle="180">
        <AnimationHeader MasterPath="gv_MasterPath"/>
        <Animation Preset="2_defense/2_guard" XFlip="true" Duration="0.5">
            <FrameEvent Type="Movement" StartTime="0" Friction="0" Speed="0" Velocity="0"/>
            <FrameEvent Type="ApplyBuff" Condition="DefenceSuccess" StartTime="0" EndTime="999" ApplyBuff="GuardCountIncrease"/>

            <FrameEvent Type="FrameTag" StartTime="0" EndTime="999" Tag="HitAvail"/>
            <FrameEvent Type="FrameTag" StartTime="0" EndTime="999" Tag="GbAvail"/>
        </Animation>

        <Branch Condition="End == true" Execute="AC_Guard"/>
    </AC_Guard>

    <AC_GuardBroken MovementType="FrameEvent" DirectionType="AttackedPoint" FlipType="Direction">
        <AnimationHeader MasterPath="gv_MasterPath"/>
        <Animation Preset="2_defense/3_guardBroken" XFlip="true" Duration="1.25">
            <FrameEvent Type="AudioPlay" StartTime="0" ID="4921" Attach="true"/>
            <FrameEvent Type="Movement" StartTime="0" Friction="0" Speed="0" Velocity="0"/>
            <FrameEvent Type="ApplyBuff" StartTime="0" ApplyBuff="GuardCountClear"/>

            <FrameEvent Type="FrameTag" StartTime="0" EndTime="999" Tag="HitAvail"/>
            <FrameEvent Type="FrameTag" StartTime="0" EndTime="999" Tag="GbAvail"/>
        </Animation>

        <Branch Condition="End == true" Execute="AC_Idle"/>
    </AC_GuardBroken>
<!-- Defense Action -->

    <AIMove MovementType="GraphPreset" MovementGraphPreset="Move" DirectionType="AI" FlipType="Direction" ActiveCollision="False">
        <AnimationHeader MasterPath="gv_MasterPath"/>
        <Animation Preset="0_default/2_move" XFlip="true" Duration="0.5">
        </Animation>

        <Branch Condition="End == true" Execute="AIMove"/>
    </AIMove>

    <AIMoveFast MovementType="GraphPreset" MovementGraphPreset="Move" DirectionType="AI" FlipType="Direction" ActiveCollision="False">
        <AnimationHeader MasterPath="gv_MasterPath"/>
        <Animation Preset="0_default/2_move" XFlip="true" Duration="0.5">
        </Animation>

        <Branch Condition="End == true" Execute="AIMoveFast"/>
    </AIMoveFast>
</ActionGraph>

<!-- 잡기 버전
    <AC_AttackMain MovementType="FrameEvent" DirectionType="AI" FlipType="Direction" RotationType="Direction" Flags="LaserEffect">
        <AnimationHeader MasterPath="gv_MasterPath"/>
        <Animation Preset="1_attack/2_attackMain" XFlip="true" Duration="0.55">
            <FrameEvent Type="Movement" StartTime="0" Friction="24" MaxVelocity="18" Velocity="18" Speed="0"/>
            <FrameEvent Type="AudioPlay" StartTime="0" ID="4901" Attach="true" Switch="True"/>
            
            <FrameEvent Type="Attack" StartTime="0" EndTime="0.35" AttackPreset="SisterSpear_Catch" AttackType="Catch" CatchOffset="0.4 0 0">
                <OnHit>
                    <FrameEvent Type="ApplyBuffTarget" ApplyBuff="CommonHalfAttack"/>
                    <FrameEvent Type="AudioPlay" StartTime="0" ID="4908" Attach="true" Switch="True"/>
                    <FrameEvent Type="EffectPreset" StartTime="0" Key="Slash"/>
                    <FrameEvent Type="EffectPreset" StartTime="0" Key="Blood"/>
                </OnHit>
                <OnCatch>
                    <FrameEvent Type="ApplyBuffTarget" ApplyBuff="CatchedSet"/>
                    <FrameEvent Type="ApplyBuffTarget" ApplyBuff="CatchAttack_SisterSpear"/>
                    
                    <FrameEvent Type="EffectPreset" StartTime="0" Key="Smash"/>
		            <FrameEvent Type="ZoomEffect" Scale="-0.4"/>
                    <FrameEvent Type="StopUpdate" Time="0.15"/>
                </OnCatch>
            </FrameEvent>
        </Animation>

        <Branch Condition="End" Execute="AC_AttackRecover"/>
    </AC_AttackMain>

    <AC_Catch_Entry MovementType="FrameEvent" DirectionType="Keep" RotationType="Direction" FlipType="Direction">
        <AnimationHeader MasterPath="gv_MasterPath"/>
        <Animation Preset="3_skill/1_catch/1_entry" XFlip="true" Duration="0.3">

            <FrameEvent Type="AudioPlay" StartTime="0" ID="2103" Attach="true" Switch="True"/>
            <FrameEvent Type="Movement" StartTime="0" Friction="12"/>
        </Animation>

        <Branch Condition="getKey_Escape_1 || getKey_Escape_2 || End" Execute="AC_Catch_Struggle"/>
    </AC_Catch_Entry>
    <AC_Catch_Struggle MovementType="FrameEvent" DirectionType="Keep" RotationType="Direction" FlipType="Direction">
        <AnimationHeader MasterPath="gv_MasterPath"/>
        <Animation Preset="3_skill/1_catch/2_struggle" XFlip="true" Duration="0.3">
            <FrameEvent Type="AudioPlay" StartTime="0" ID="2411" Attach="true" Switch="True"/>
            <FrameEvent Type="Movement" StartTime="0" Speed="0" Velocity="2" MaxVelocity="5" Friction="12"/>
        </Animation>

        <Branch Condition="getKey_Escape_1 || getKey_Escape_2 || End" Execute="AC_Catch_Entry"/>
    </AC_Catch_Struggle>
    <AC_Catch_Away MovementType="FrameEvent" DirectionType="Keep" RotationType="Direction" FlipType="Direction">
        <AnimationHeader MasterPath="gv_MasterPath"/>
        <Animation Preset="3_skill/1_catch/3_away" XFlip="true" Duration="0.9">
        
            <FrameEvent Type="Movement" StartTime="0" Friction="4" MaxVelocity="9" Velocity="-4" Speed="0"/>

            <FrameEvent Type="FrameTag" StartTime="0" EndTime="999" Tag="HitAvail"/>
            <FrameEvent Type="FrameTag" StartTime="0" EndTime="999" Tag="GbAvail"/>

        </Animation>
        <Branch Condition="End" Execute="AC_Idle"/>
    </AC_Catch_Away>
-->    

