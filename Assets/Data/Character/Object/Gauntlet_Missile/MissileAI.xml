<AIGraph Name="MissileAI" DefaultState="Launch">

    <Include Path="Assets/Data/AILibrary/Package/CommonDeadPackage.xml"/>
    <Include Path="Assets/Data/AILibrary/Package/CommonIdlePackage.xml"/>
    <Include Path="Assets/Data/AILibrary/Package/CommonChasePackage.xml"/>

    <AIPackage Name="MissileChasePackage" DefaultState="AI_Launch">
        <AIState>
            <AI_Launch UpdateTime="0.0" TargetSearchType="Near" TargetSearchRange="999.9" AllyTarget="Enemy">
                <Event_OnExecute>
                    <AIEvent Type="SetDirectionToTarget" Speed="120"/>
                    <AIEvent Type="SetAction" Action="AC_Lanch"/>
                </Event_OnExecute>
                <Event_OnFrame>
                    <AIEvent Type="SetDirectionToTarget" Speed="120"/>
                </Event_OnFrame>
                
                <Branch Condition="PackageExecutedTime >= 2.0" Execute="AI_Chase"/>
            </AI_Launch>
            <AI_Chase UpdateTime="0" TargetSearchType="Near" TargetSearchRange="999.9" AllyTarget="Enemy">
                <Event_OnExecute>
                    <AIEvent Type="SetDirectionToTarget" Speed="360"/>
                    <AIEvent Type="SetAction" Action="AC_Move"/>
                </Event_OnExecute>

                <Event_OnFrame>
                    <AIEvent Type="SetDirectionToTarget" Speed="360"/>
                </Event_OnFrame>
                
                <Branch Condition="AngleToTarget <= 1.0" Execute="AI_ChaseLockOn"/>
            </AI_Chase>
            <AI_ChaseLockOn UpdateTime="0" TargetSearchType="Near" TargetSearchRange="999.9" AllyTarget="Enemy">
                <Event_OnExecute>
                    <AIEvent Type="SetDirectionToTarget"/>
                    <AIEvent Type="SetAction" Action="AC_Move"/>
                </Event_OnExecute>

                <Event_OnFrame>
                    <AIEvent Type="SetDirectionToTarget"/>
                </Event_OnFrame>
                
                <Branch Condition="End" Execute="AI_ChaseLockOn"/>
            </AI_ChaseLockOn>
            <AI_ExploChase UpdateTime="0.1" TargetSearchType="Near" TargetSearchRange="999.9" AllyTarget="Enemy">
                <Event_OnExecute>
                    <AIEvent Type="SetAction" Action="AC_ExplosionChase"/>
                </Event_OnExecute>
                
                <Event_OnFrame>
                    <AIEvent Type="SetDirectionToTarget"/>
                </Event_OnFrame>
                
                <Branch Condition="End" Execute="AI_ExploChase"/>
            </AI_ExploChase>
            <AI_Explosion UpdateTime="0.1" TargetSearchType="Near" TargetSearchRange="999.9" AllyTarget="Enemy">
                <Event_OnExecute>
                    <AIEvent Type="SetAction" Action="AC_Explosion"/>
                </Event_OnExecute>
                
                <Branch Condition="End" Execute="TerminatePackage"/>
            </AI_Explosion>
            <AI_Reverse UpdateTime="0" TargetSearchType="Near" TargetSearchRange="999.9" AllyTarget="Enemy">
                <Event_OnExecute>
                    <AIEvent Type="SetAction" Action="AC_Reverse"/>
                </Event_OnExecute>

                <Event_OnFrame>
                    <AIEvent Type="SetDirectionToTarget" Speed="360"/>
                </Event_OnFrame>

                <Branch Condition="End" Execute="TerminatePackage"/>
            </AI_Reverse>
            <TerminatePackage>
                <Event_OnExecute>
                    <AIEvent Type="TerminatePackage"/>
                </Event_OnExecute>
            </TerminatePackage>
        </AIState>
    </AIPackage>

    <Launch Package="MissileChasePackage">
        <Branch Condition="Dead" Execute="Dead"/>
        <Branch Condition="AttackSuccess" Execute="Explosion"/>
        <Branch Condition="GuardBroken || GuardBreakFail" Execute="Reverse"/>
        <Branch Condition="GraphExecutedTime >= 5.0" Execute="ExploChase"/>
    </Launch>
    <Chase Package="MissileChasePackage" EntryNode="AI_Chase">
        <Branch Condition="Dead" Execute="Dead"/>
        <Branch Condition="AttackSuccess" Execute="Explosion"/>
        <Branch Condition="GuardBroken || GuardBreakFail" Execute="Reverse"/>
        <Branch Condition="GraphExecutedTime >= 5.0" Execute="ExploChase"/>
    </Chase>

    <ExploChase Package="MissileChasePackage" EntryNode="AI_ExploChase">
        <Branch Condition="Dead" Execute="Dead"/>
        <Branch Condition="AttackSuccess" Execute="Explosion"/>
        <Branch Condition="GuardBroken || GuardBreakFail" Execute="ExploReverse"/>
        <Branch Condition="GraphExecutedTime >= 3.0" Execute="Explosion"/>
    </ExploChase>

    <Reverse Package="MissileChasePackage" EntryNode="AI_Reverse">
        <Branch Condition="Dead" Execute="Dead"/>
        <Branch Condition="CurrentPackageEnd" Execute="Chase"/>
    </Reverse>

    <ExploReverse Package="MissileChasePackage" EntryNode="AI_Reverse">
        <Branch Condition="Dead" Execute="Dead"/>
        <Branch Condition="CurrentPackageEnd" Execute="ExploChase"/>
    </ExploReverse>

    <Explosion Package="MissileChasePackage" EntryNode="AI_Explosion">
        <Branch Condition="Dead" Execute="Dead"/>
        <Branch Condition="CurrentPackageEnd" Execute="Dead"/>
    </Explosion>

    <Dead Package="CommonDeadPackage">
    </Dead>


</AIGraph>