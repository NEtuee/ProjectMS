<AIGraph Name="SportsMachineAI" DefaultState="Entry_Battle">

<!-- 옵션 설정 -->

    <!-- 전투 상태 행동 타입 설정 -->
    <!-- 공격 거리 설정 -->
    <GlobalVariable Name="gv_AttackRangeMin"           Value="0.0"/>       <!-- 최소 공격 사거리 : Value보다 PC가 가까우면 공격하지 않는다. -->
    <GlobalVariable Name="gv_AttackRangeMax"           Value="6.0"/>       <!-- 최대 공격 사거리 : Value보다 PC가 멀면 공격하지 않는다. -->

<!-- 옵션 설정 -->

<!-- 패키지 인클루드 -->
    <!-- 패키지 인클루드 : 공통 -->
    <Include Path="Assets/Data/AILibrary/Package/EmptyPackage.xml"/>          <!-- 사망 패키지 -->
    <Include Path="Assets/Data/AILibrary/Package/CommonDeadPackage.xml"/>          <!-- 사망 패키지 -->
    <Include Path="Assets/Data/AILibrary/Package/CommonHitPackage.xml"/>           <!-- 피격 패키지 -->
    <Include Path="Assets/Data/AILibrary/Package/CommonGuardBrokenPackage.xml"/>   <!-- 가드 해제 패키지 -->
    <!-- 패키지 인클루드 : 평화 상태 -->
    <Include Path="Assets/Data/AILibrary/Package/CommonIdlePackage.xml"/>          <!-- 대기 패키지 -->
    <!-- 패키지 인클루드 : 전투 상태 -->
    <Include Path="Assets/Data/Character/Object/03_SportsMachine/SportsMachineShootingPackage.xml"/>          <!-- 스킬 패키지 -->
<!-- 패키지 인클루드 -->

<!-- 간이 테스트 스크립트 -->
    <BranchSet Name="TestBranchA">
        <Branch Condition="CurrentPackageEnd" Execute="Test"/>
    </BranchSet>
    <BranchSet Name="TestBranchB">
        <Branch Condition="CurrentPackageEnd" Execute="Test"/>
    </BranchSet>

   <Test Package="EmptyPackage">
        <UseBranchSet Name="TestBranchA"/>
        <UseBranchSet Name="TestBranchB"/>
    </Test>
<!-- 간이 테스트 스크립트 -->

<!-- 브랜치 셋 -->
    
    <!-- 전투 행동 초기화 브랜치 셋 -->
    <BranchSet Name="BattlePackageEndSet">
        <Branch Condition="CurrentPackageEnd" Execute="Entry_Battle"/>
    </BranchSet>

    <!-- 피격 리액션 브랜치 셋 -->
    <BranchSet Name="HitReactionSet">
        <Branch Condition="Dead" Execute="Dead"/>
        <Branch Condition="Hit && getFrameTag_HitAvail" Execute="Hit"/>
        <Branch Condition="GuardBreakFail && getFrameTag_GbAvail" Execute="GuardBroken"/>
        <Branch Condition="GuardBroken && getFrameTag_GbAvail" Execute="GuardBroken"/>
    </BranchSet>
<!-- 브랜치 셋 -->

<!-- 스테이트 -->

    <!-- AI 스테이트 : 전투 상태 : 분기 -->
    <Entry_Battle Package="CommonIdlePackage">
        <Branch Condition="true"  Execute="Battle_JudgeDist"/>
    </Entry_Battle>

    <Battle_JudgeDist Package="CommonIdlePackage">
        <Branch Condition="(TargetDistance > gv_AttackRangeMax)" Execute="Battle_Far"/>             <!-- 사거리 밖 -->
        <!-- <Branch Condition="(TargetDistance < gv_AttackRangeMin)" Execute="Battle_Closer"/> -->
        <Branch Condition="true" Execute="Battle_Range"/>                                           <!-- 사정거리 -->
    </Battle_JudgeDist>

    <Battle_Far Package="CommonIdlePackage">
        <Branch Condition="true" Execute="Movement"/>
    </Battle_Far>
    <Battle_Range Package="CommonIdlePackage">
        <Branch Condition="aiGraphCoolTime_Shooting" Execute="Shooting"/>
        <Branch Condition="true" Execute="Movement"/>
    </Battle_Range>
    
    <!-- AI 스테이트 : 전투 상태 : 이동 -->
    <Movement Package="CommonIdlePackage">
        <UseBranchSet Name="HitReactionSet"/>
        <!-- Movement Release -->
        <Branch Condition="(TargetDistance <= gv_AttackRangeMax)" Execute="Battle_JudgeDist"/>      <!-- Distance Check-->
        <Branch Condition="(GraphExecutedTime >= 3.0)" Execute="Entry_Battle"/>                     <!-- Executed Time Check-->
        
    </Movement>

    <!-- AI 스테이트 : 전투 상태 : 스킬 -->
    <Shooting Package="SportsMachineShootingPackage" CoolTime="6.0">
        <UseBranchSet Name="HitReactionSet"/>
        <UseBranchSet Name="BattlePackageEndSet"/>
    </Shooting>

    <!-- AI 스테이트 : 피격 상태 : 리액션 -->
    <Hit Package="CommonHitPackage">
        <UseBranchSet Name="HitReactionSet"/>
        <UseBranchSet Name="BattlePackageEndSet"/>
    </Hit>

    <GuardBroken Package="CommonGuardBrokenPackage">
        <UseBranchSet Name="HitReactionSet"/>
        <UseBranchSet Name="BattlePackageEndSet"/>
    </GuardBroken>

    <Dead Package="CommonDeadPackage">
    </Dead>
<!-- 스테이트 -->

</AIGraph>