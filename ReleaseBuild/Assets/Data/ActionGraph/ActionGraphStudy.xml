
<ActionGraph Name="Test" DefaultAction="Idle" DefaultFramePerSecond="4">

    <BranchSet Name="CommonMoveBranchSet">
        <Branch Condition="ActionDash == true" Execute="Dash"/>
        <Branch Condition="ActionTest == false" Execute="Idle"/>
    </BranchSet>

    <BranchSet Name="CommonBattleBranchSet">
        <Branch Condition="InputAttackCharge == true" Execute="AttackCharge"/>
    </BranchSet>



    <CommonMoveSelection IsActionSelection="true">
        <Branch Condition="ActionTest == true" Execute="MoveSelection"/>
        <UseBranchSet Name="CommonMoveBranchSet"/>
    </CommonMoveSelection>

    <MoveSelection IsActionSelection="true">
        
        <Branch Condition="(AngleDirection >= 45.0) && (AngleDirection < 135.0)" Execute="MoveUp"/>
        <Branch Condition="(AngleDirection >= 225.0) && (AngleDirection < 315.0)" Execute="MoveDown"/>

        <Branch Condition="(AngleDirection < 45.0) || (AngleDirection >= 315.0) && (IsXFlip == false)" Execute="MoveRightForward"/>
        <Branch Condition="(AngleDirection >= 135.0) && (AngleDirection < 225.0) && (IsXFlip == false)" Execute="MoveRightBackward"/>
        
        <Branch Condition="(AngleDirection >= 135.0) && (AngleDirection < 225.0) && (IsXFlip == true)" Execute="MoveLeftForward"/>
        <Branch Condition="(AngleDirection < 45.0) || (AngleDirection >= 315.0) && (IsXFlip == true)" Execute="MoveLeftBackward"/>
        
    </MoveSelection>

    <AttackSelection IsActionSelection="true">
        <Branch Condition="(AngleDirection < 45.0) || (AngleDirection >= 315.0)" Execute="Attack"/>
        <Branch Condition="(AngleDirection >= 45.0) && (AngleDirection < 135.0)" Execute="AttackUp"/>
        <Branch Condition="(AngleDirection >= 135.0) && (AngleDirection < 225.0)" Execute="Attack"/>
        <Branch Condition="(AngleDirection >= 225.0) && (AngleDirection < 315.0)" Execute="AttackDown"/>
    </AttackSelection>



    <Idle DirectionType="Keep" FlipType="MousePoint">
        <Animation Path="Resources/Sprites/Player/idle/" StartFrame="0" EndFrame="7" FramePerSecond="8" XFlip="true">
        </Animation>

        <UseBranchSet Name="CommonBattleBranchSet"/>
        <Branch Condition="ActionTest == true" Execute="MoveSelection"/>
        <Branch Condition="End == true" Execute="Idle"/>
    </Idle>




    <MoveUp MovementType="GraphPreset" MovementGraphPreset="Move" DirectionType="MoveInput" FlipType="MousePoint">
        <Animation Path="Resources/Sprites/Player/moveUp/" StartFrame="0" EndFrame="5" FramePerSecond="8" XFlip="true">
        </Animation>

        <UseBranchSet Name="CommonBattleBranchSet"/>
        <UseBranchSet Name="CommonMoveBranchSet"/>

        <Branch Condition="(AngleDirection >= 45.0) && (AngleDirection < 135.0) == false" Execute="MoveSelection"/>
        <Branch Condition="End == true" Execute="MoveUp"/>
    </MoveUp>

    <MoveDown MovementType="GraphPreset" MovementGraphPreset="Move" DirectionType="MoveInput" FlipType="MousePoint">
        <Animation Path="Resources/Sprites/Player/moveDown/" StartFrame="0" EndFrame="5" FramePerSecond="8" XFlip="true">
        </Animation>
        <UseBranchSet Name="CommonBattleBranchSet"/>
        <UseBranchSet Name="CommonMoveBranchSet"/>

        <Branch Condition="(AngleDirection >= 225.0) && (AngleDirection < 315.0) == false" Execute="MoveSelection"/>
        <Branch Condition="End == true" Execute="MoveDown"/>
    </MoveDown>




    <MoveRightForward MovementType="GraphPreset" MovementGraphPreset="Move" DirectionType="MoveInput" FlipType="MousePoint">
        <Animation Path="Resources/Sprites/Player/moveFront/" StartFrame="0" EndFrame="5" FramePerSecond="8" XFlip="true">
        </Animation>
        <UseBranchSet Name="CommonBattleBranchSet"/>
        <UseBranchSet Name="CommonMoveBranchSet"/>

        <Branch Condition="IsXFlip == true" Execute="MoveSelection"/>
        <Branch Condition="(AngleDirection < 45.0) || (AngleDirection >= 315.0) == false" Execute="MoveSelection"/>
        <Branch Condition="End == true" Execute="MoveRightForward"/>
    </MoveRightForward>

    <MoveRightBackward MovementType="GraphPreset" MovementGraphPreset="Move" DirectionType="MoveInput" FlipType="MousePoint">
        <Animation Path="Resources/Sprites/Player/moveBack/" StartFrame="0" EndFrame="5" FramePerSecond="8" XFlip="true">
        </Animation>
        <UseBranchSet Name="CommonBattleBranchSet"/>
        <UseBranchSet Name="CommonMoveBranchSet"/>

        <Branch Condition="IsXFlip == true" Execute="MoveSelection"/>
        <Branch Condition="(AngleDirection >= 135.0) && (AngleDirection < 225.0) == false" Execute="MoveSelection"/>
        <Branch Condition="End == true" Execute="MoveRightBackward"/>
    </MoveRightBackward>






    <MoveLeftForward MovementType="GraphPreset" MovementGraphPreset="Move" DirectionType="MoveInput" FlipType="MousePoint">
        <Animation Path="Resources/Sprites/Player/moveFront/" StartFrame="0" EndFrame="5" FramePerSecond="8" XFlip="true">
        </Animation>
        <UseBranchSet Name="CommonBattleBranchSet"/>
        <UseBranchSet Name="CommonMoveBranchSet"/>

        <Branch Condition="IsXFlip == false" Execute="MoveSelection"/>
        <Branch Condition="(AngleDirection >= 135.0) && (AngleDirection < 225.0) == false" Execute="MoveSelection"/>
        <Branch Condition="End == true" Execute="MoveLeftForward"/>
    </MoveLeftForward>

    <MoveLeftBackward MovementType="GraphPreset" MovementGraphPreset="Move" DirectionType="MoveInput" FlipType="MousePoint">
        <Animation Path="Resources/Sprites/Player/moveBack/" StartFrame="0" EndFrame="5" FramePerSecond="8" XFlip="true">
        </Animation>
        <UseBranchSet Name="CommonBattleBranchSet"/>
        <UseBranchSet Name="CommonMoveBranchSet"/>

        <Branch Condition="IsXFlip == false" Execute="MoveSelection"/>
        <Branch Condition="(AngleDirection < 45.0) || (AngleDirection >= 315.0) == false" Execute="MoveSelection"/>
        <Branch Condition="End == true" Execute="MoveLeftBackward"/>
    </MoveLeftBackward>






    <Dash MovementType="GraphPreset" MovementGraphPreset="Dash" DirectionType="Keep" FlipType="AlwaysTurnOff" RotationType="Direction">
        <Animation Path="Resources/Sprites/DummyPlayer/dash/" StartFrame="0" EndFrame="1" FramePerSecond="3" XFlip="true">
        </Animation>
        <UseBranchSet Name="CommonBattleBranchSet"/>
        <Branch Condition="End == true" Execute="Idle"/>
    </Dash>




    <Attack_Parried MovementType="GraphPreset" MovementGraphPreset="AttackGuarded" DirectionType="Keep" FlipType="Keep">
        <Animation Path="Resources/Sprites/DummyPlayer/Attack/" StartFrame="0" EndFrame="1" FramePerSecond="1">
        </Animation>

        <Branch Condition="End == true" Execute="MoveSelection"/>
    </Attack_Parried>
    
    <Attack_Guarded MovementType="GraphPreset" MovementGraphPreset="AttackGuarded" DirectionType="Keep" FlipType="Keep">
        <Animation Path="Resources/Sprites/DummyPlayer/Attack/" StartFrame="0" EndFrame="1" FramePerSecond="1">
        </Animation>

        <Branch Condition="End == true" Execute="MoveSelection"/>
    </Attack_Guarded>




    <AttackCharge MovementType="Empty" DirectionType="MousePoint" FlipType="Direction">
        <Animation Path="Resources/Sprites/DummyPlayer/AttackCharge/" StartFrame="0" EndFrame="1" FramePerSecond="3" XFlip="true">
        </Animation>

        <Branch Condition="InputAttackCharge == false" Execute="AttackSelection"/>
        <Branch Condition="End == true" Execute="AttackCharge"/>
    </AttackCharge>

    <Attack MovementType="GraphPreset" MovementGraphPreset="Attack" DirectionType="Keep" FlipType="Keep">
        <Animation Path="Resources/Sprites/DummyPlayer/Attack/" StartFrame="0" EndFrame="1" FramePerSecond="3">
            <FrameEvent Type="Attack" StartFrame="0" AttackPreset="PlayerAttackTest">
                <OnHit>
                    <FrameEvent Type="ApplyBuffTarget" ApplyBuff="1"/>
                    <FrameEvent Type="ApplyBuff" ApplyBuff="6 7"/>
                </OnHit>
                
                <OnParry>
                    <FrameEvent Type="TeleportToTarget"/>
                </OnParry>
                
                <OnGuard>
                    <FrameEvent Type="TeleportToTarget"/>
                </OnGuard>
            </FrameEvent>
        </Animation>


        <Branch Condition="AttackParried == true" Execute="Attack_Parried"/>
        <Branch Condition="AttackGuarded == true" Execute="Attack_Guarded"/>
        <Branch Condition="End == true" Execute="MoveSelection"/>
    </Attack>

    <AttackUp MovementType="GraphPreset" MovementGraphPreset="Attack" DirectionType="Keep" FlipType="Keep">
        <Animation Path="Resources/Sprites/DummyPlayer/AttackUp/" StartFrame="0" EndFrame="1" FramePerSecond="3">
            <FrameEvent Type="Attack" StartFrame="0" AttackPreset="PlayerAttackTest">
                <OnHit>
                    <FrameEvent Type="ApplyBuffTarget" ApplyBuff="1"/>
                    <FrameEvent Type="ApplyBuff" ApplyBuff="6 7"/>
                </OnHit>
                
                <OnParry>
                    <FrameEvent Type="TeleportToTarget"/>
                </OnParry>
                
                <OnGuard>
                    <FrameEvent Type="TeleportToTarget"/>
                </OnGuard>
            </FrameEvent>
        </Animation>

        <Branch Condition="AttackParried == true" Execute="Attack_Parried"/>
        <Branch Condition="AttackGuarded == true" Execute="Attack_Guarded"/>
        <Branch Condition="End == true" Execute="MoveSelection"/>
    </AttackUp>

    <AttackDown MovementType="GraphPreset" MovementGraphPreset="Attack" DirectionType="Keep" FlipType="Keep">
        <Animation Path="Resources/Sprites/DummyPlayer/AttackDown/" StartFrame="0" EndFrame="1" FramePerSecond="3">
            <FrameEvent Type="Attack" StartFrame="0" AttackPreset="PlayerAttackTest">
                <OnHit>
                    <FrameEvent Type="ApplyBuffTarget" ApplyBuff="1"/>
                    <FrameEvent Type="ApplyBuff" ApplyBuff="6 7"/>
                </OnHit>
                
                <OnParry>
                    <FrameEvent Type="TeleportToTarget"/>
                </OnParry>
                
                <OnGuard>
                    <FrameEvent Type="TeleportToTarget"/>
                </OnGuard>
            </FrameEvent>
        </Animation>


        <Branch Condition="AttackParried == true" Execute="Attack_Parried"/>
        <Branch Condition="AttackGuarded == true" Execute="Attack_Guarded"/>
        <Branch Condition="End == true" Execute="MoveSelection"/>
    </AttackDown>

    

</ActionGraph>